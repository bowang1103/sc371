#lang plai-typed

(define (strCompare (str1 : string) (str2 : string)) : number
  (let ([seq1 (string->list str1)]
        [seq2 (string->list str2)])
    (charsCompare seq1 seq2)))

(define (charsCompare (str1 : (listof char)) (str2 : (listof char))) : number
  (if (< (length str1) (length str2))
      (* -1 (charsCompare str2 str1))
      (cond 
        [(and (empty? str1) (empty? str2)) 0]
        [(empty? str2) 1]
        [else (let ([char1 (some-v (hash-ref ascii (first str1)))]
                    [char2 (some-v (hash-ref ascii (first str2)))])
                (cond
                  [(> char1 char2) 1]
                  [(< char1 char2) -1]
                  [else (charsCompare (rest str1) (rest str2))]))])))

(define ascii (hash (list
	(values #\space 32)
	(values #\! 33)
	(values #\" 34)
	(values #\# 35)
	(values #\$ 36)
	(values #\% 37)
	(values #\& 38)
	(values #\' 39)
	(values #\( 40)
	(values #\) 41)
	(values #\* 42)
	(values #\+ 43)
	(values #\, 44)
	(values #\- 45)
	(values #\. 46)
	(values #\/ 47)
	(values #\0 48)
	(values #\1 49)
	(values #\2 50)
	(values #\3 51)
	(values #\4 52)
	(values #\5 53)
	(values #\6 54)
	(values #\7 55)
	(values #\8 56)
	(values #\9 57)
	(values #\: 58)
	(values #\; 59)
	(values #\< 60)
	(values #\= 61)
	(values #\> 62)
	(values #\? 63)
	(values #\@ 64)
	(values #\A 65)
	(values #\B 66)
	(values #\C 67)
	(values #\D 68)
	(values #\E 69)
	(values #\F 70)
	(values #\G 71)
	(values #\H 72)
	(values #\I 73)
	(values #\J 74)
	(values #\K 75)
	(values #\L 76)
	(values #\M 77)
	(values #\N 78)
	(values #\O 79)
	(values #\P 80)
	(values #\Q 81)
	(values #\R 82)
	(values #\S 83)
	(values #\T 84)
	(values #\U 85)
	(values #\V 86)
	(values #\W 87)
	(values #\X 88)
	(values #\Y 89)
	(values #\Z 90)
	(values #\[ 91)
	(values #\\ 92)
	(values #\] 93)
	(values #\^ 94)
	(values #\_ 95)
	(values #\` 96)
	(values #\a 97)
	(values #\b 98)
	(values #\c 99)
	(values #\d 100)
	(values #\e 101)
	(values #\f 102)
	(values #\g 103)
	(values #\h 104)
	(values #\i 105)
	(values #\j 106)
	(values #\k 107)
	(values #\l 108)
	(values #\m 109)
	(values #\n 110)
	(values #\o 111)
	(values #\p 112)
	(values #\q 113)
	(values #\r 114)
	(values #\s 115)
	(values #\t 116)
	(values #\u 117)
	(values #\v 118)
	(values #\w 119)
	(values #\x 120)
	(values #\y 121)
	(values #\z 122)
	(values #\{ 123)
	(values #\| 124)
	(values #\} 125)
	(values #\~ 126)
)))